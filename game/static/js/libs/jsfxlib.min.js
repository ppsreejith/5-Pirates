define(function(){var audio={};(function(a){var d=this.SampleRate=a||44100,b=2*d,h=String.fromCharCode,v=function(u){u=["RIFF",36+(l=u.length),"WAVEfmt ",16,1,1,d,b,2,16,"data",l,u];var a="";for(c=0;c<u.length;c++)a+="s"=="s4s4224422s4s"[c]?u[c]:f(u[c],"s4s4224422s4s".charCodeAt(c)-48);return a};this.make=function(a){return new Audio("data:audio/wav;base64,"+btoa(v(q(a))))};this.makeWaveFile=function(a){a="data:audio/wav;base64,"+btoa(v(q(a)));document.location.href=a};var f=function(a,g){return g?h(a&255)+f(a>>8,g-1):""},p,c,
r=Math.sin,k=2*Math.PI;this.toTime=function(a){return a/d};this.toSamples=function(a){return a*d};var q=function(a){var g="",b=a.length;for(c=0;c<b;c++)var m=32767*a[c]|0,m=-32768>m?-32768:32767<m?32767:m,m=m+(0>m?65536:0),g=g+String.fromCharCode(m&255,m>>8);return g};this.adjustVolume=function(a,g){for(c=0;c<a.length;c++)a[c]*=g;return a};var y=this.filter=function(a,g,b,m,d,f,k,h,v,n){b=b?b:1;m=m?m:a.length;p=a.slice(0);for(c=b;c<m;c++)p[c]=g(a,p,b,m,c,d,f,k,h,v,n);return p},z=this.filters={lowpass:function(a,
g,b,c,d,f){return g[d-1]+f*(a[d]-g[d-1])},lowpassx:function(a,g,b,d,c,f){return g[c-1]+f*(d-c)/(d-b)*(a[c]-g[c-1])},highpass:function(a,g,b,d,c,f){return f*(g[c-1]+a[c]-a[c-1])}};this.f={lowpass:function(a,g,b,c){return y(a,z.lowpass,g,b,c)},lowpassx:function(a,g,b,c){return y(a,z.lowpassx,g,b,c)},highpass:function(a,b,c,d){return y(a,z.highpass,b,c,d)}};this.generate=function(a,b,f,h,p,v,n,q,r){b=b*k/d;var s=Array(a|0);for(c=0;c<a;c++)s[c]=f(c*b,h,p,v,n,q,r);return s};var H=0,s=this.generate,n=this.generators=
{noise:function(a){4>a%k&&(H=2*Math.random()-1);return H},uninoise:Math.random,sine:Math.sin,synth:function(a){return r(a)+0.5*r(a/2)+0.3*r(a/4)},saw:function(a){return 2*(a/k-(a/k+0.5|0))},square:function(a,b){return r(a)>b?1:r(a)<b?-1:b}};this.g={noise:function(a){return s(a,0,n.noise)},sine:function(a,b){return s(a,b,n.sine)},synth:function(a,b){return s(a,b,n.synth)},saw:function(a,b){return s(a,b,n.saw)},square:function(a,b,c){return s(a,b,n.square,c)}}}).apply(audio);var jsfx={};(function(){this.Parameters=[];this.Generators={square:audio.generators.square,saw:audio.generators.saw,sine:audio.generators.sine,noise:audio.generators.noise,synth:audio.generators.synth};this.getGeneratorNames=function(){var a=[];for(e in this.Generators)a.push(e);return a};this.getParameters=function(){var a=[],d=0,b=function(b,f,h,c,r){void 0===r&&(r=(h-f)/1E3);b={name:b,id:b.replace(/ /g,""),min:f,max:h,step:r,def:c,type:"range",group:d};a.push(b)},h=this.getGeneratorNames();(function(b,f,h){b=
{name:b,id:b.replace(/ /g,""),options:f,def:h,type:"option",group:d};a.push(b)})("Generator",h,h[0]);b("Super Sampling Quality",0,16,0,1);b("Master Volume",0,1,0.4);d++;b("Attack Time",0,1,0.1);b("Sustain Time",0,2,0.3);b("Sustain Punch",0,3,2);b("Decay Time",0,2,1);d++;b("Min Frequency",20,2400,0,1);b("Start Frequency",20,2400,440,1);b("Max Frequency",20,2400,2E3,1);b("Slide",-1,1,0);b("Delta Slide",-1,1,0);d++;b("Vibrato Depth",0,1,0);b("Vibrato Frequency",0.01,48,8);b("Vibrato Depth Slide",-0.3,
1,0);b("Vibrato Frequency Slide",-1,1,0);d++;b("Change Amount",-1,1,0);b("Change Speed",0,1,0.1);d++;b("Square Duty",0,0.5,0);b("Square Duty Sweep",-1,1,0);d++;b("Repeat Speed",0,0.8,0);d++;b("Phaser Offset",-1,1,0);b("Phaser Sweep",-1,1,0);d++;b("LP Filter Cutoff",0,1,1);b("LP Filter Cutoff Sweep",-1,1,0);b("LP Filter Resonance",0,1,0);b("HP Filter Cutoff",0,1,0);b("HP Filter Cutoff Sweep",-1,1,0);return a};this.generate=function(a){var d=2*Math.PI,b=Math.sin,h=Math.pow,v=Math.abs,f=audio.SampleRate,
p=a.SuperSamplingQuality|0;1>p&&(p=1);for(var f=f*p,c=[{from:0,to:1,time:a.AttackTime},{from:1+a.SustainPunch,to:1,time:a.SustainTime},{from:1,to:0,time:a.DecayTime}],r=c.length,k=0;k<r;k++)c[k].samples=1+(c[k].time*f|0);for(var q=void 0,y=0,z=-1,H=0,s=-1,n=0,k=0;k<r;k++)n+=c[k].samples;n<f/2&&(n=f/2);var u=Array(n/p|0),g=0,L=0,m=jsfx.Generators[a.Generator];void 0===m&&(m=this.Generators.square);var x=0,x=a.SquareDuty;square_slide=a.SquareDutySweep/f;var D=0,t=a.StartFrequency*d/f,M=1+64*h(a.Slide,
3)/f,E=h(a.DeltaSlide,3)/(1E3*f);void 0!==p&&(E/=p);a.MinFrequency>a.StartFrequency&&(a.MinFrequency=a.StartFrequency);a.MaxFrequency<a.StartFrequency&&(a.MaxFrequency=a.StartFrequency);for(var X=a.MinFrequency*d/f,Y=a.MaxFrequency*d/f,S=0,T=a.VibratoFrequency*d/f,B=a.VibratoDepth,$=1+3*h(a.VibratoFrequencySlide,3)/f,N=a.VibratoDepthSlide/f,O=0,U=a.ChangeSpeed*f,I=h(a.ChangeAmount,2),I=0<a.ChangeAmount?1+10*I:1-0.9*I,V=Array(1024),k=0;1024>k;k++)V[k]=0;var P=0,w=1020*h(a.PhaserOffset,2),J=4E3*h(a.PhaserSweep,
3)/f,aa=1E-5<v(J)||1E-5<v(w),ba=0.001<a.HPFilterCutoff||0.999>a.LPFilterCutoff,F=0,G=0,C=h(a.LPFilterCutoff,3)/10,ca=1+a.HPFilterCutoffSweep/1E4,K=5/(1+20*h(a.LPFilterResonance,2))*(0.01+a.LPFilterCutoff);0.8<K&&(K=0.8);var K=1-K,da=0.999>a.LPFilterCutoff,Q=0,A=h(a.HPFilterCutoff,2)/10,ea=1+a.HPFilterCutoffSweep/1E4,R=0,Z=n;0<a.RepeatSpeed&&(Z=h(1-a.RepeatSpeed,2)*f+32);for(var fa=a.MasterVolume,W=0,k=0;k<n;k++)g=m(D,x,0),x+=square_slide,0>x?x=0:0.5<x&&(x=0.5),R>Z&&(D=0,t=a.StartFrequency*d/f,M=1+
3*h(a.Slide,3)/f,E=h(a.DeltaSlide,3)/(1E3*f),void 0!==p&&(E/=p),O=0,U=a.ChangeSpeed*f,I=1+(a.ChangeAmount|0)/12,R=0),R+=1,D+=t,M+=E,t*=M,O>U&&(t*=I,U=n),O+=1,t>Y?t=Y:t<X&&(t=X),S+=T,q=t*b(S)*B,D+=q,T*=$,N&&(B+=N,0>B?N=B=0:1<B&&(B=1,N=0)),ba&&(0.001<v(A)&&(A*=ea,1E-5>A?A=1E-5:0.1<A&&(A=0.1)),q=F,C*=ca,0>C?C=0:0.1<C&&(C=0.1),da?(G+=(g-F)*C,G*=K):(F=g,G=0),F+=G,Q+=F-q,g=Q*=1-A),aa&&(w+=J,0>w&&(w=-w,J=-J),1023<w&&(w=1023,J=0),V[P]=g,g+=V[P-(w|0)+1024&1023],P=P+1&1023),k>s&&(z+=1,q=z<r?c[z]:{from:0,to:0,
samples:n},y=q.from,H=(q.to-q.from)/(q.samples+1),s+=q.samples),g*=y,y+=H,g*=fa,1<p?(L+=g,0===(k+1)%p&&(u[W]=L/p,W+=1,L=0)):u[k]=g;a=f/100|0;padding=Array(a);for(k=0;k<a;k++)padding[k]=0;return padding.concat(u).concat(padding)};this.Parameters=this.getParameters()}).apply(jsfx);var jsfxlib={};
(function(){this.createWaves=function(a){var d={},b;for(b in a)d[b]=this.createWave(a[b]);return d};this.createWave=function(a){a=this.arrayToParams(a);a=jsfx.generate(a);return audio.make(a)};this.paramsToArray=function(a){for(var d=[],b=jsfx.Parameters.length,h=0;h<b;h++)d.push(a[jsfx.Parameters[h].id]);return d};this.arrayToParams=function(a){for(var d={},b=jsfx.Parameters.length,h=0;h<b;h++)d[jsfx.Parameters[h].id]=a[h];return d}}).apply(jsfxlib);return jsfxlib;});
